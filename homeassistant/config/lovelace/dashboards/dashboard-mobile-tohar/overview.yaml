---

title: "Overview"
cards:
  - type: horizontal-stack
    cards:
      - type: custom:decluttering-card
        template: person
        variables:
          - name: yuval
      - type: custom:decluttering-card
        template: person
        variables:
          - name: tohar

  - type: entities
    title: "זמני היום"
    show_header_toggle: false
    entities:
      - entity: sensor.jewish_calendar_date
        name: "תאריך"
      - type: conditional
        conditions:
          - entity: binary_sensor.tzom
            state: 'on'
        row:
          entity: binary_sensor.tzom
      - type: conditional
        conditions:
          - entity: binary_sensor.is_omer
            state: 'on'
        row:
          entity: sensor.jewish_calendar_day_of_the_omer
          name: "ספירת העומר"
      - type: divider
      - entity: sensor.jewish_calendar_parshat_hashavua
        name: "פרשת השבוע"
      - entity: sensor.jewish_calendar_upcoming_candle_lighting
        type: custom:multiple-entity-row
        name: "הדלקת נרות"
        format: relative
        entities:
          - entity: sensor.jewish_calendar_upcoming_candle_lighting
            format: time
            name: false
      - entity: sensor.jewish_calendar_upcoming_havdalah
        type: custom:multiple-entity-row
        name: "הבדלה"
        format: relative
        entities:
          - entity: sensor.jewish_calendar_upcoming_havdalah
            format: time
            name: false

  - type: entities
    entities:
      - type: custom:sun-card
      - type: custom:weather-card
        entity: weather.openweathermap
        current: true
        details: true
        hourly_forecast: true
        number_of_forecasts: 5
      - type: custom:hui-element
        card_type: markdown
        content: >-
          {{
            states.sensor.israel_weather_forecast.attributes.entries[0].summary
          }}
      - type: custom:air-visual-card
        hide_title: true
        air_pollution_level: sensor.u_s_air_pollution_level
        air_quality_index: sensor.u_s_air_quality_index
        main_pollutant: sensor.u_s_main_pollutant

  - type: conditional
    conditions:
      - entity: binary_sensor.issur_melacha_eve
        state: 'on'
    card:
      type: entities
      entities:
        - type: custom:button-card
          color_type: label-card
          color: rgb(44, 109, 214)
          name: "פיקוד שבת"
        - type: custom:hui-element
          card_type: horizontal-stack
          cards:
            - type: custom:button-card
              color_type: blank-card
            - type: custom:button-card
              entity: switch.shabbat_mode
            - type: custom:button-card
              entity: switch.shabbat_plate
              name: "פלטה"
              icon: >-
                [[[
                  if (entity.state == 'off')
                    return 'mdi:pot';
                  else
                    return 'mdi:pot-steam';
                ]]]
            - type: custom:button-card
              color_type: blank-card
        - type: custom:time-picker-card
          entity: input_datetime.shabbat_lights_off_time
          link_values: true
          minute_step: 30
          layout:
            name: inside
            align_controls: right

  - type: horizontal-stack
    cards:
      - type: custom:button-card
        entity: switch.night_light_override
      - type: custom:button-card
        entity: switch.disable_auto_clean
      - type: custom:button-card
        entity: switch.guest_mode

  - type: custom:auto-entities
    card:
      type: entities
      title: "Active Lights"
      show_header_toggle: false
    show_empty: false
    filter:
      include:
        - domain: light
          state: 'on'
        - domain: light
          state: 'unavailable'
      exclude:
        - entity_id: '*lights'

  - type: entities
    show_header_toggle: false
    entities:
      - type: custom:hui-element
        card_type: light
        entity: light.living_room_lights
      - type: custom:hui-element
        card_type: horizontal-stack
        cards:
          - type: light
            entity: light.wall
          - type: light
            entity: light.wall_2
      - switch.night_light_override

  - type: entities
    entities:
      - type: custom:vacuum-card
        entity: vacuum.mi_vacuum
        map: camera.vacuum_map
        map-refresh: 10
        stats:
          default:
            - attribute: filter_left
              unit: hours
              subtitle: "Filter"
            - attribute: side_brush_left
              unit: hours
              subtitle: "Side brush"
            - attribute: main_brush_left
              unit: hours
              subtitle: "Main brush"
            - attribute: sensor_dirty_left
              unit: hours
              subtitle: Sensors
          cleaning:
            - attribute: cleaned_area
              unit: m2
              subtitle: "Cleaning area"
            - attribute: cleaning_time
              unit: minutes
              subtitle: "Cleaning time"
        # actions:
      - type: custom:hui-element
        card_type: markdown
        entity_id: vacuum.mi_vacuum
        content: |
          Last cleaned at {{ as_timestamp(states('sensor.vacuum_last_clean_end')) | timestamp_custom('%A at %H:%M')}}
          It took {{ ((states('sensor.vacuum_last_clean_duration') | int) / 60) | int }} minutes to clean {{ states('sensor.vacuum_last_clean_area') }} meters.

#  - type: custom:decluttering-card
#    template: multisensor
#    variables:
#      - room: master_bedroom

  - type: entities
    show_header_toggle: false
    entities:
      - type: custom:hui-element
        card_type: horizontal-stack
        cards:
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.master_bedroom_sensibo_temperature
                name: "Temperature"
                show_points: false
              - entity: sensor.master_bedroom_climate_set_temp
                color: 'white'
                show_fill: false
              - !include ../../resources/graph_card_sun_elevation.yaml
            font_size: 80
            color_thresholds: !include ../../resources/graph_card_temperature_thresholds.yaml
            points_per_hour: 6
            show:
              fill: fade
              points: false
              labels: true
              labels_secondary: false
              legend: false
          - type: custom:mini-graph-card
            entities:
              - entity: sensor.master_bedroom_sensibo_humidity
                name: "Humidity"
                color: '#74A4F4'
              - !include ../../resources/graph_card_sun_elevation.yaml
            font_size: 80
            lower_bound: 0
            upper_bound: 100
            points_per_hour: 12
            show:
              fill: fade
              points: false
              labels: false
              legend: false

  - type: entities
    entities:
      - type: custom:hui-element
        card_type: light
        entity: light.yeelight_color_master_bedroom

  - type: entities
    entities:
      - type: custom:battery-entity-row
        entity: sensor.yuval_battery_level
        name: "Yuval battery"
        charging: true
      - entity: sensor.yuval_next_alarm
        name: "Alarm"
      - type: divider
      - type: custom:battery-entity-row
        entity: sensor.tohar_battery_level
        name: "Tohar battery"
        charging: true
      - entity: sensor.tohar_next_alarm
        name: "Alarm"

  # - type: entities
  #   show_header_toggle: false
  #   entities:
  #     - type: custom:hui-element
  #       card_type: light
  #       entity: light.kids_ambient_lights
  #     - type: custom:hui-element
  #       card_type: horizontal-stack
  #       cards:
  #         - type: entities
  #           entities:
  #             - type: custom:hui-element
  #               card_type: light
  #               entity: light.wled_harel_bed
  #             - type: custom:rgb-light-card
  #               entity: light.wled_harel_bed
  #               colors: !include ../../resources/rgb_colors_rotem.yaml
  #         - type: entities
  #           entities:
  #             - type: custom:hui-element
  #               card_type: light
  #               entity: light.wled_rotem_bed
  #             - type: custom:rgb-light-card
  #               entity: light.wled_rotem_bed
  #               colors: !include ../../resources/rgb_colors_rotem.yaml

  # - type: custom:decluttering-card
  #   template: multisensor
  #   variables:
  #     - room: bathroom
